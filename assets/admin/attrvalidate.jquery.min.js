!function(e){function i(){e(v).find("input, select, textarea, fieldset").removeClass("invalid"),e(v).find(".error-indicator").attr("aria-hidden",!0),e(v).find("#errorSummary").remove()}function t(i){h=e.extend({showFieldIndicator:!0,showErrorSummary:!0,errorSummaryMsg:"Please fix the following issues before continuing:",validateTel:!0,telRegex:/^\+*[\d-()]{7,20}$/,validateEmail:!0,emailRegex:/^(\S+@\S+)*$/,validateDate:!0,validateNumber:!0},i),v=this,a(),e(v).bind("submit",n)}function a(){var i=[];e(v).find("input, select[required], textarea[required]").each(function(){if(m(e(this))&&e(this).is("[required]")){var t=e(this).attr("name");-1===e.inArray(t,i)&&(e(this).attr("data-do-validate",!0),d(e(this)),h.showFieldIndicator&&e(this).parents("fieldset").first().append(e(y)),e(v).find('input[name="'+e(this).attr("name")+'"]').each(function(){e(this).change(function(){r(e(this))})}),i.push(t))}else(e(this).is("[required]")||h.validateTel&&e(this).is('input[type="tel"]')||h.validateEmail&&e(this).is('input[type="email"]')||h.validateDate&&e(this).is('input[type="date"]')||h.validateNumber&&e(this).is('input[type="number"]'))&&(e(this).attr("data-do-validate",!0),d(e(this)),h.showFieldIndicator&&((e(this).is('input[type="radio"]')||e(this).is('input[type="checkbox"]'))&&e(this).next("label").length>0?e(this).next("label").after(e(y)):e(this).after(e(y))),e(this).change(function(){r(e(this))}))})}function r(e){var i=s(e);if(i.isValid)p(e);else{var t=l(e,i.type);o(e,t)}}function n(i){i.preventDefault();var t=!0,a=[];return e(v).find("#errorSummary").remove(),e(v).find('[data-do-validate="true"]').each(function(){var i=s(e(this));if(i.isValid)p(e(this));else{var r=l(e(this),i.type);a.push({elem:e(this).prop("id"),msg:r}),o(e(this),r),t=!1}}),t?void("undefined"!=typeof h.submitFunction?h.submitFunction():v[0].submit()):(h.showErrorSummary&&u(a),!1)}function s(i){if(!i.is(":visible")||i.parents('[aria-hidden="true"]').length>0)return{isValid:!0};if(i.is('input[type="radio"]'))return i.is("[required]")?m(i)?{isValid:e(v).find('input[name="'+i.attr("name")+'"]:checked').length>0,type:x.required}:{isValid:i.is(":checked"),type:x.required}:{isValid:!0};if(i.is('input[type="checkbox"]'))return{isValid:!i.is("[required]")||i.is(":checked"),type:x.required};if(i.is("[required]")&&""===i.val())return{isValid:!1,type:x.required};if(h.validateTel&&i.is('input[type="tel"]'))return{isValid:h.telRegex.test(i.val().replace(/ /g,"")),type:x.tel};if(h.validateEmail&&i.is('input[type="email"]'))return{isValid:h.emailRegex.test(i.val().trim()),type:x.email};if(h.validateDate&&i.is('input[type="date"]')){var t;return t=""===i.val().trim()?!0:isNaN(Date.parse(i.val()))?!1:i.prop("max")&&!isNaN(Date.parse(i.prop("max")))&&Date.parse(i.val())>Date.parse(i.prop("max"))?!1:i.prop("min")&&!isNaN(Date.parse(i.prop("min")))&&Date.parse(i.val())<Date.parse(i.prop("min"))?!1:!0,{isValid:t,type:x.date}}if(h.validateNumber&&i.is('input[type="number"]')){var t;return t=""===i.val().trim()?!0:isNaN(parseFloat(i.val()))?!1:i.prop("max")&&!isNaN(parseFloat(i.prop("max")))&&parseFloat(i.val())>parseFloat(i.prop("max"))?!1:i.prop("min")&&!isNaN(parseFloat(i.prop("min")))&&parseFloat(i.val())<parseFloat(i.prop("min"))?!1:!0,{isValid:t,type:x.number}}return{isValid:!0}}function d(i){if("undefined"==typeof i.data("error-msg")||""===i.data("error-msg")){var t,a=e(v).find('label[for="'+i.attr("id")+'"]');t=a.length>0&&""!==e(a[0]).text()?e(a[0]).text():i.attr("name"),i.data("error-name",t)}}function l(e,i){var t;return t="undefined"!=typeof e.data("error-msg")&&""!==e.data("error-msg")?e.data("error-msg"):e.data("error-name")+i.msg}function o(e,i){m(e)?(e.parents("fieldset").first().addClass("invalid"),h.showFieldIndicator&&e.parents("fieldset").first().find(".error-indicator").first().text(i).attr("aria-hidden",!1)):(e.addClass("invalid"),h.showFieldIndicator&&e.nextAll(".error-indicator").first().text(i).attr("aria-hidden",!1))}function p(i){if(m(i)){i.parents("fieldset").removeClass("invalid"),h.showFieldIndicator&&i.parents("fieldset").first().find(".error-indicator").first().attr("aria-hidden",!0);var t=e(v).find('input[name="'+i.attr("name")+'"]').first(),a=e('#errorSummary li a[data-field="'+t.attr("id")+'"]');a.length>0&&(a.parent("li").remove(),0===e("#errorSummary ul li").length&&e("#errorSummary").remove())}else{i.removeClass("invalid"),h.showFieldIndicator&&i.nextAll(".error-indicator").first().attr("aria-hidden",!0);var a=e('#errorSummary li a[data-field="'+i.attr("id")+'"]');a.length>0&&(a.parent("li").remove(),0===e("#errorSummary ul li").length&&e("#errorSummary").remove())}}function u(i){for(var t=e(g.replace("{0}",h.errorSummaryMsg)),a=e("<ul></ul>"),r=0;r<i.length;r++){var n=e('<a href="#" data-field="'+i[r].elem+'">'+i[r].msg+"</a>");n.click(function(){return f(e(this).data("field")),!1});var s=e("<li></li>");s.append(n),a.append(s)}t.append(a).prependTo(e(v)),t.focus()}function m(e){return e.is('input[type="radio"]')&&"undefined"!=typeof e.attr("name")&&""!==e.attr("name")}function f(i){e(v).find("#"+i).focus()}var h,v,c={reset:i},y='<span class="error-indicator" role="alert" aria-live="assertive" aria-hidden="true"></span>',g='<div id="errorSummary" class="alert alert-danger" role="alert" aria-live="assertive" tabindex="-1"><p>{0}</p></div>',x={required:{msg:" is required"},tel:{msg:" is not a valid phone number"},email:{msg:" is not a valid email address"},date:{msg:" is not a valid date"},number:{msg:" is not a valid number"}};e.fn.attrvalidate=function(){if(!this.is("form"))return this;if("string"==typeof arguments[0]){var e=(arguments[1],Array.prototype.slice.call(arguments));e.splice(0,1),c[arguments[0]].apply(this,e)}else t.apply(this,arguments);return this}}(jQuery);
